generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url = env("DATABASE_URL")
    directUrl = env("DIRECT_URL") 
}

model User {
  id          String   @id @default(uuid())
  username    String   @unique
  email       String   @unique
  passwordHash String
  firstName   String
  lastName    String
  role        String   @default("Student") // Student, Instructor, Admin
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  @@map("users")
  @@index([createdAt])
}

model Instructor {
  id         String    @id @default(uuid())
  firstName  String
  lastName   String
  specialty  String
  email      String    @unique
  hireDate   DateTime
  createdAt  DateTime  @default(now())

  // Relations
  courses    Course[]

  @@map("instructors")
  @@index([createdAt])
}

model Course {
  id           String      @id @default(uuid())
  title        String
  description  String
  instructorId String
  duration     Int          // En heures
  maxStudents  Int
  price        Decimal
  level        String       // Beginner, Intermediate, Advanced
  createdAt    DateTime     @default(now())

  // Relations
  instructor   Instructor   @relation(fields: [instructorId], references: [id], onDelete: Cascade)
  enrollments  Enrollment[]

  @@map("courses")
  @@index([createdAt])
}

model Student {
  id               String      @id @default(uuid())
  firstName        String
  lastName         String
  email            String      @unique
  registrationDate DateTime
  level            String      // Beginner, Intermediate, Advanced
  createdAt        DateTime    @default(now())

  // Relations
  enrollments      Enrollment[]

  @@map("students")
  @@index([createdAt])
}

model Enrollment {
  id              String    @id @default(uuid())
  courseId        String
  studentId       String
  enrollmentDate  DateTime  @default(now())
  status          String    @default("Active") // Active, Completed, Cancelled
  grade           Decimal?  // nullable
  createdAt       DateTime  @default(now())

  // Relations
  course          Course    @relation(fields: [courseId], references: [id], onDelete: Cascade)
  student         Student   @relation(fields: [studentId], references: [id], onDelete: Cascade)

  @@map("enrollments")
  @@index([createdAt])
}